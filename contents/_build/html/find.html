
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finding things &#8212; Learning APL</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Partitions" href="cookbook1.html" />
    <link rel="prev" title="Trainspotting" href="tacit.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo2.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Learning APL</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="array.html">
   It’s arrays all the way down
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexing.html">
   Indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="manip.html">
   Glyphiary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   Direct functions and operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iteration.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="key.html">
   The Key operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⌸
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="at.html">
   The At operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     @
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rank.html">
   The Rank/Atop operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍤
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stencil.html">
   The Stencil operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⌺
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="over.html">
   The Över operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍥
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dyadictrn.html">
   Dyadic transpose:
   <code class="docutils literal notranslate">
    <span class="pre">
     A⍉B
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="decode.html">
   Encode decode:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⊤⊥
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="products.html">
   Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tacit.html">
   Trainspotting
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Finding things
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cookbook1.html">
   Partitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="namespaces.html">
   Namespaces
   <code class="docutils literal notranslate">
    <span class="pre">
     ⎕NS
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="io.html">
   Dealing with real data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aplway.html">
   The APL Way
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="workflow.html">
   A Dyalog workflow. Or two.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="next.html">
   What now?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tldr.html">
   Too long; didn’t read
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/find.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ffind.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equality">
   Equality
   <code class="docutils literal notranslate">
    <span class="pre">
     =
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#index-of-ab">
   Index-of
   <code class="docutils literal notranslate">
    <span class="pre">
     A⍳B
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#find">
   Find
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍷
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regular-expessions">
   Regular expessions
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="finding-things">
<h1>Finding things<a class="headerlink" href="#finding-things" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Computer languages of the future will be more concerned with goals and less with procedures specified by the programmer.
–<em>Marvin Minsky</em></p>
</div></blockquote>
<p>Just like with indexing, there seem to be a baffling array of ways to locate items in arrays in APL. As stated in <a class="reference external" href="https://zen-of-python.info/">The Zen of Python</a>:</p>
<blockquote>
<div><p>There should be one– and preferably only one –obvious way to do it.</p>
</div></blockquote>
<p>Aha. About that…</p>
<p><img alt="laugh" src="https://media.giphy.com/media/JmD9mkDmzvXE7nxy7j/giphy-downsized-medium.gif" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕IO</span> <span class="kd">←</span> <span class="m">0</span>
<span class="kt">{}</span><span class="nf">⎕SE</span><span class="na">.</span><span class="nv">UCMD</span><span class="s1">&#39;box on -s=min -t=tree -f=on&#39;</span>
<span class="kt">{}</span><span class="nf">⎕SE</span><span class="na">.</span><span class="nv">UCMD</span><span class="s1">&#39;rows on&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">Rebuilding user command cache... done

Rebuilding user command cache... done
</span></div></div>
</div>
<div class="section" id="equality">
<h2>Equality <code class="docutils literal notranslate"><span class="pre">=</span></code><a class="headerlink" href="#equality" title="Permalink to this headline">¶</a></h2>
<p>So how do you locate where an element resides in an array in APL? Well, the obvious way to do it is to exploit equality and scalar extension. Where is the number 2?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">data</span> <span class="kd">←</span> <span class="m">4</span> <span class="m">1</span> <span class="m">22</span> <span class="m">20</span> <span class="m">16</span> <span class="m">10</span> <span class="m">25</span> <span class="m">7</span> <span class="m">18</span> <span class="m">11</span> <span class="m">15</span> <span class="m">2</span> <span class="m">12</span> <span class="m">23</span> <span class="m">9</span> <span class="m">17</span> <span class="m">6</span> <span class="m">14</span> <span class="m">21</span> <span class="m">19</span> <span class="m">3</span> <span class="m">8</span> <span class="m">5</span> <span class="m">13</span> <span class="m">24</span>
<span class="m">2</span><span class="o">=</span><span class="nv">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">4 1 22 20 16 10 25 7 18 11 15 2 12 23 9 17 6 14 21 19 3 8 5 13 24
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0
</span></div></div>
</div>
<p>That surely qualifies in the Zen of Python sense. Hands up every item that equals 2. We can find out the actual index, too, by using <em>iota-underbar</em>, <code class="docutils literal notranslate"><span class="pre">⍸</span></code>, which in its monadic form is appropriately enough called <em>where</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸</span><span class="m">2</span><span class="o">=</span><span class="nv">data</span> <span class="c1">⍝ Where is data = 2?</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">11
</span></div></div>
</div>
<p>As we should expect by now, scalar extension lets scalar functions penetrate any level of nesting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">nested</span> <span class="kd">←</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span> <span class="p">(</span><span class="m">3</span> <span class="m">4</span> <span class="m">5</span><span class="p">))(</span><span class="m">4</span> <span class="p">(</span><span class="m">1</span> <span class="m">2</span><span class="p">(</span><span class="m">3</span> <span class="m">4</span><span class="p">)))</span>
<span class="m">4</span><span class="o">=</span><span class="nv">nested</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───────────┬─────────────┐
│┌─┬─┬─────┐│┌─┬─────────┐│
││1│2│3 4 5│││4│┌─┬─┬───┐││
│└─┴─┴─────┘││ ││1│2│3 4│││
│           ││ │└─┴─┴───┘││
│           │└─┴─────────┘│
└───────────┴─────────────┘
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───────────┬─────────────┐
│┌─┬─┬─────┐│┌─┬─────────┐│
││0│0│0 1 0│││1│┌─┬─┬───┐││
│└─┴─┴─────┘││ ││0│0│0 1│││
│           ││ │└─┴─┴───┘││
│           │└─┴─────────┘│
└───────────┴─────────────┘
</span></div></div>
</div>
</div>
<div class="section" id="index-of-ab">
<h2>Index-of <code class="docutils literal notranslate"><span class="pre">A⍳B</span></code><a class="headerlink" href="#index-of-ab" title="Permalink to this headline">¶</a></h2>
<p>Another way we can find the index of things is via <em>index of</em>, dyadic <code class="docutils literal notranslate"><span class="pre">⍳</span></code>, which we have actually met before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">data</span><span class="o">⍳</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">11
</span></div></div>
</div>
<p>Dyadic iota finds the <em>first</em> index - or 1 plus the last index if not found. This has the nice feature that we can feed it an array to the right:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">data</span><span class="o">⍳</span><span class="m">2</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">11 20
</span></div></div>
</div>
<p>Which, if we want to do it with equality requires a bit more dexterity – but this approach would also spot multiples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⍸∨</span><span class="na">⌿</span><span class="m">2</span> <span class="m">3</span> <span class="na">∘.</span><span class="o">=</span> <span class="nv">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">11 20
</span></div></div>
</div>
<p>What about if we crank the rank a bit?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">mat</span><span class="kd">←</span><span class="m">4</span> <span class="m">4</span><span class="o">⍴</span><span class="m">2</span> <span class="m">15</span> <span class="m">16</span> <span class="m">14</span> <span class="m">11</span> <span class="m">9</span> <span class="m">12</span> <span class="m">10</span> <span class="m">13</span> <span class="m">1</span> <span class="m">7</span> <span class="m">5</span> <span class="m">4</span> <span class="m">8</span> <span class="m">6</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace"> 2 15 16 14
11  9 12 10
13  1  7  5
 4  8  6  3
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">mask</span><span class="kd">←</span><span class="m">7</span><span class="o">=</span><span class="nv">mat</span>
<span class="o">⍸</span><span class="nv">mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 0 0 0
0 0 0 0
0 0 1 0
0 0 0 0
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┐
│2 2│
└───┘
</span></div></div>
</div>
<p>Gotta love APL.</p>
</div>
<div class="section" id="find">
<h2>Find <code class="docutils literal notranslate"><span class="pre">⍷</span></code><a class="headerlink" href="#find" title="Permalink to this headline">¶</a></h2>
<p>There is of course also a glyph that’s called <em>find</em>, <code class="docutils literal notranslate"><span class="pre">⍷</span></code>. Find locates the start-points of subsequences:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;ana&#39;</span> <span class="o">⍷</span> <span class="s1">&#39;banana&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 1 0 0
</span></div></div>
</div>
<p>That combines nicely with <code class="docutils literal notranslate"><span class="pre">⍸</span></code> as a tacit atop to give a bit of an idiom to commit to memory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">substr</span> <span class="kd">←</span> <span class="o">⍸⍷</span>
<span class="s1">&#39;ana&#39;</span> <span class="nv">substr</span> <span class="s1">&#39;banana&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 3
</span></div></div>
</div>
<p>We can use find to locate arrays-in-arrays of higher ranks, too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">⊢</span><span class="nv">needle</span> <span class="kd">←</span> <span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="m">0</span>
<span class="o">⊢</span><span class="nv">haystack</span> <span class="kd">←</span> <span class="m">4</span> <span class="m">4</span><span class="o">⍴</span><span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1
1 0
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">0 1 0 0
1 0 0 1
0 0 1 0
0 1 0 0
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">needle</span> <span class="o">⍷</span> <span class="nv">haystack</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1 0 0 0
0 0 1 0
0 1 0 0
0 0 0 0
</span></div></div>
</div>
<p>The 1s represent the top-left corners of the ‘needle’ array in ‘haystack’:</p>
<p><img alt="find1" src="_images/find1.png" /></p>
<p>and we can pick out the actual coordinates using the same idiom we used for <code class="docutils literal notranslate"><span class="pre">substring</span></code> above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">needle</span> <span class="p">(</span><span class="o">⍸⍷</span><span class="p">)</span> <span class="nv">haystack</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌───┬───┬───┐
│0 0│1 2│2 1│
└───┴───┴───┘
</span></div></div>
</div>
</div>
<div class="section" id="regular-expessions">
<h2>Regular expessions<a class="headerlink" href="#regular-expessions" title="Permalink to this headline">¶</a></h2>
<p>Dyalog supports regular expressions through the most excellent <a class="reference external" href="http://help.dyalog.com/18.0/index.htm#Language/Appendices/PCRE%20Regular%20Expression%20Details.htm">PCRE</a> engine. Dyalog’s docs on the topic can be found <a class="reference external" href="http://help.dyalog.com/18.0/index.htm#Language/System%20Functions/r.htm">here</a>, and an APL Orchard cultivation was dedicated to the <a class="reference external" href="https://chat.stackexchange.com/rooms/52405/conversation/lesson-24-r-and-s">topic</a>, too.</p>
<p>How regexes themselves work is beyond the scope of this book, but let’s take a look at how they’re integrated in Dyalog.</p>
<p>Two system operators, <code class="docutils literal notranslate"><span class="pre">⎕S</span></code> and <code class="docutils literal notranslate"><span class="pre">⎕R</span></code>, implement regex search and replace respectively. They’re both dyadic operators, taking regular expression(s) to the left and transformation(s) to the right. The derived function can be applied to text data.</p>
<p>Here’s a simple example. Using a transformation string of <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, <code class="docutils literal notranslate"><span class="pre">⎕S</span></code> returns a vector of what was matched:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;ll.\sw&#39;</span><span class="nf">⎕S</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)</span><span class="s1">&#39;hello world well  worn&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┬─────┐
│llo w│ll  w│
└─────┴─────┘
</span></div></div>
</div>
<p>The left operand can be a nested vector of regexes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;he&#39;</span> <span class="s1">&#39;wo&#39;</span> <span class="s1">&#39;ll&#39;</span><span class="nf">⎕S</span><span class="s1">&#39;&amp;&#39;</span> <span class="o">⊢</span> <span class="s1">&#39;hello world well  worn&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌──┬──┬──┬──┬──┐
│he│ll│wo│ll│wo│
└──┴──┴──┴──┴──┘
</span></div></div>
</div>
<p>The right operand can be a function, too. This is where it gets a bit ~hairy~ flexible. We could have written the above as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;he&#39;</span> <span class="s1">&#39;wo&#39;</span> <span class="s1">&#39;ll&#39;</span><span class="nf">⎕S</span><span class="kt">{</span><span class="bp">⍵</span><span class="na">.</span><span class="nv">Match</span><span class="kt">}</span> <span class="o">⊢</span> <span class="s1">&#39;hello world well  worn&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌──┬──┬──┬──┬──┐
│he│ll│wo│ll│wo│
└──┴──┴──┴──┴──┘
</span></div></div>
</div>
<p>In other words, the right operand function gets passed a <em>namespace</em> representing the match at that point. In this case, the <code class="docutils literal notranslate"><span class="pre">⍵.Match</span></code> holds “what the current regex matched” - the same as the magic transformation short-hand <code class="docutils literal notranslate"><span class="pre">'&amp;'</span></code>. We need to rely on a right operand function to make the most of regex capture groups. It’s a bit of a shame that we don’t have Perl’s default capture group behaviour, or Python’s <code class="docutils literal notranslate"><span class="pre">re.findall()</span></code>, but we can achieve the same thing, succumbing to an unusually verbose operand:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">groups</span><span class="kd">←</span><span class="kt">{</span><span class="bp">⍵</span><span class="na">.</span><span class="p">(</span><span class="m">1</span><span class="o">↓</span><span class="nv">Lengths</span><span class="o">↑</span><span class="na">¨</span><span class="nv">Offsets</span><span class="o">↓</span><span class="na">¨</span><span class="o">⊂</span><span class="nv">Block</span><span class="p">)</span><span class="kt">}</span> <span class="c1">⍝ This is worth remembering!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;(a{2,}|b{2,})&#39;</span><span class="nf">⎕S</span> <span class="nv">groups</span> <span class="s1">&#39;aaabababbbbbaaaa&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┬───────┬──────┐
│┌───┐│┌─────┐│┌────┐│
││aaa│││bbbbb│││aaaa││
│└───┘│└─────┘│└────┘│
└─────┴───────┴──────┘
</span></div></div>
</div>
<p>When using a function operand, we have the opportunity to apply the full might of APL to the matches. In the example above we picked out stretches of 2 or longer of <code class="docutils literal notranslate"><span class="pre">a</span></code> or <code class="docutils literal notranslate"><span class="pre">b</span></code>. How long were they?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;(a{2,}|b{2,})&#39;</span><span class="nf">⎕S</span><span class="kt">{</span><span class="o">≢⊃</span><span class="bp">⍵</span><span class="na">.</span><span class="p">(</span><span class="m">1</span><span class="o">↓</span><span class="nv">Lengths</span><span class="o">↑</span><span class="na">¨</span><span class="nv">Offsets</span><span class="o">↓</span><span class="na">¨</span><span class="o">⊂</span><span class="nv">Block</span><span class="p">)</span><span class="kt">}</span><span class="s1">&#39;aaabababbbbbaaaa&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">3 5 4
</span></div></div>
</div>
<p>The regex replacement operator, <code class="docutils literal notranslate"><span class="pre">⎕R</span></code>, operates much in the same way, but here the right operand represents a substitution into the right argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a.a&#39;</span><span class="nf">⎕R</span><span class="s1">&#39;AXA&#39;</span><span class="o">⊢</span><span class="s1">&#39;abababadabaaba&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AXAbAXAdAXAAXA
</span></div></div>
</div>
<p>In the right operand we can refer to capture groups as backslash-X where X is a number from 1 to 9, following the Perl convention:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a(.)a&#39;</span><span class="nf">⎕R</span><span class="s1">&#39;A\1A&#39;</span><span class="o">⊢</span><span class="s1">&#39;abababadabaaba&#39;</span> <span class="c1">⍝ \1 is the first capture group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">AbAbAbAdAbAAbA
</span></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "dyalog-kernel"
        },
        kernelOptions: {
            kernelName: "dyalog-kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'dyalog-kernel'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="tacit.html" title="previous page">Trainspotting</a>
    <a class='right-next' id="next-link" href="cookbook1.html" title="next page">Partitions</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Stefan Kruger, Computational Array and Magic<br/>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>